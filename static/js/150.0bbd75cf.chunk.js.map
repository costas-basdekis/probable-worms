{"version":3,"file":"static/js/150.0bbd75cf.chunk.js","mappings":"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","sources":["worms/RollResult.tsx","worms/DiceRoll.tsx","worms/Chest.tsx","worms/Results.tsx","worms/Evaluation.tsx","worms/EvaluationCache.tsx","worms/UnrolledState.tsx","worms/RolledState.tsx","worms/UnrolledStateEvaluator.tsx","worms/RolledStateEvaluator.tsx","EvaluationCacheCache.tsx","worker.tsx","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["export type RollResult = 1 | 2 | 3 | 4 | 5 | \"W\";\nexport const Worm: RollResult = \"W\";\nexport const rollResults: RollResult[] = [1, 2, 3, 4, 5, Worm];\nexport const ValueMap: Map<RollResult, number> = new Map([\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [Worm, 5],\n] as [RollResult, number][]);\n","import _ from \"underscore\";\nimport {RollResult, rollResults, ValueMap} from \"./RollResult\";\n\nexport class DiceRoll {\n  counts: Map<RollResult, number>;\n  key: string;\n  total: number;\n\n  static fromDice(dice: RollResult[]): DiceRoll {\n    return new DiceRoll(\n      Object.values(_.groupBy(dice)).map((group) => [group[0], group.length])\n    );\n  }\n\n  constructor(items?: Iterable<readonly [RollResult, number]>) {\n    this.counts = new Map(items as Iterable<readonly [RollResult, number]>);\n    this.key = JSON.stringify(Array.from(this.counts.entries()).sort());\n    this.total = Array.from(this.counts.entries()).reduce(\n      (total, [roll, count]) => total + ValueMap.get(roll)! * count,\n      0\n    );\n  }\n\n  adding(roll: RollResult, count: number): DiceRoll {\n    return new DiceRoll([\n      ...Array.from(this.counts.entries()),\n      [roll, count] as [RollResult, number],\n    ]);\n  }\n\n  get(key: RollResult): number | undefined {\n    return this.counts.get(key);\n  }\n\n  has(key: RollResult): boolean {\n    return this.counts.has(key);\n  }\n\n  keys(): Iterable<RollResult> {\n    return this.counts.keys();\n  }\n\n  entries(): Iterable<[RollResult, number]> {\n    return this.counts.entries();\n  }\n\n  get count(): number {\n    return this.counts.size;\n  }\n\n  get diceCount(): number {\n    return Array.from(this.counts.values()).reduce((total, current) => total + current, 0);\n  }\n\n  get dice(): RollResult[] {\n    return Array.from(this.counts.entries()).map(([roll, count]) => _.range(count).map(() => roll)).flat().sort((lhs, rhs) => {\n      return ValueMap.get(lhs)! - ValueMap.get(rhs)!;\n    });\n  }\n\n  replacing(roll: RollResult, count: number): DiceRoll {\n    const counts = new Map(this.counts.entries());\n    if (count) {\n      counts.set(roll, count);\n    } else if (counts.has(roll)) {\n      counts.delete(roll);\n    }\n    return new DiceRoll(counts.entries());\n  }\n\n  static getNextRolls(diceCount: number): {diceRoll: DiceRoll, count: number}[] {\n    const diceRollInfoByKey: Map<string, {diceRoll: DiceRoll, count: number}> = new Map();\n\n    for (const diceRoll of DiceRoll.iterateDiceRolls(diceCount)) {\n      if (!diceRollInfoByKey.has(diceRoll.key)) {\n        diceRollInfoByKey.set(diceRoll.key, { diceRoll, count: 0 });\n      }\n      diceRollInfoByKey.get(diceRoll.key)!.count += 1;\n    }\n\n    return Array.from(diceRollInfoByKey.values());\n  }\n\n  static *iterateDiceRolls(count: number): Iterable<DiceRoll> {\n    if (!count) {\n      return;\n    }\n    function *addLayer<T>(lists: Iterable<T[]>, layer: T[]): Iterable<T[]> {\n      for (const list of lists) {\n        for (const newItem of layer) {\n          yield [...list, newItem];\n        }\n      }\n    }\n    let items: Iterable<RollResult[]> = [[]];\n    for (const _1 in _.range(count)) {\n      items = addLayer(items, rollResults);\n    }\n    for (const item of items) {\n      yield DiceRoll.fromDice(item);\n    }\n  }\n}\n","import { DiceRoll } from \"./DiceRoll\";\nimport { RollResult, Worm } from \"./RollResult\";\n\nexport class Chest {\n  diceCounts: DiceRoll;\n  hasWorms: boolean;\n\n  static initial(): Chest {\n    return new Chest(new DiceRoll(), false);\n  }\n\n  static fromDiceRoll(diceRoll: DiceRoll): Chest {\n    return new Chest(new DiceRoll(diceRoll.entries()), diceRoll.has(Worm));\n  }\n\n  static fromDice(dice: RollResult[]): Chest {\n    return this.fromDiceRoll(DiceRoll.fromDice(dice));\n  }\n\n  constructor(diceCounts: DiceRoll, hasWorms: boolean) {\n    this.diceCounts = diceCounts;\n    this.hasWorms = hasWorms;\n  }\n\n  get total(): number {\n    return this.diceCounts.total;\n  }\n\n  get diceCount(): number {\n    return this.diceCounts.diceCount;\n  }\n\n  get dice(): RollResult[] {\n    return this.diceCounts.dice;\n  }\n\n  get key(): string {\n    return this.diceCounts.key;\n  }\n\n  uniqueDice(): RollResult[] {\n    return Array.from(this.diceCounts.keys()).sort();\n  }\n\n  canAdd(roll: RollResult): boolean {\n    return !this.diceCounts.has(roll);\n  }\n\n  add(roll: RollResult, diceCount: number): Chest {\n    if (!this.canAdd(roll)) {\n      throw new Error(\"Cannot add existing dice to chest\");\n    }\n    return new Chest(\n      this.diceCounts.adding(roll, diceCount), \n      this.hasWorms || roll === Worm,\n    );\n  }\n\n  get(roll: RollResult): number {\n    return this.diceCounts.get(roll) || 0;\n  }\n\n  replacing(roll: RollResult, count: number): Chest {\n    return Chest.fromDiceRoll(this.diceCounts.replacing(roll, count));\n  }\n}\n","import _ from \"underscore\";\n\nexport type SerialisedResults = [number, number][];\nexport type CompressedSerialisedResults = [number, number, number][];\n\nexport class Results {\n  counts: Map<number, number>;\n\n  static deserialise(serialised: SerialisedResults): Results {\n    return new Results(serialised);\n  }\n\n  static deserialiseCompressed(serialisedCompressed: CompressedSerialisedResults): Results {\n    const expandedTriples: [number, number][][] = serialisedCompressed.map(\n      ([min, max, ratio]) => _.range(min, max + 1).map(\n        (total) => [total, ratio]));\n    return new Results(expandedTriples.flat());\n  }\n\n  constructor(items?: Iterable<readonly [number, number]>) {\n    this.counts = new Map(items as Iterable<readonly [number, number]>);\n  }\n\n  get(key: number): number | undefined {\n    return this.counts.get(key);\n  }\n\n  set(key: number, value: number): this {\n    this.counts.set(key, value);\n    return this;\n  }\n\n  keys(): Iterable<number> {\n    return this.counts.keys();\n  }\n\n  entries(): Iterable<[number, number]> {\n    return this.counts.entries();\n  }\n\n  mergeWith(other: Results): this {\n    for (const [total, count] of other.entries()) {\n      this.set(total, (this.get(total) || 0) + count);\n    }\n    return this;\n  }\n\n  add(result: number, count: number): void {\n    this.set(result, (this.get(result) || 0) + count);\n  }\n\n  get total(): number {\n    return Array.from(this.counts.values()).reduce(\n      (total, current) => total + current,\n      0\n    );\n  }\n\n  toFixed(): Results {\n    return new Results(\n      Array.from(this.entries()).map(([key, value]: [number, number]) => {\n        if (isNaN(parseFloat(value.toFixed(6)))) {\n          throw new Error(\n            `Value was not a number, it was a ${\n              value?.constructor?.name || value\n            }: ${value}`\n          );\n        }\n        return [key, parseFloat(value.toFixed(6))] as [number, number];\n      })\n    );\n  }\n\n  serialise(): SerialisedResults {\n    return Array.from(this.entries())\n  }\n\n  serialiseCompressed(): CompressedSerialisedResults {\n    return this.serialise().sort(([lTotal], [rTotal]) => lTotal - rTotal).reduce((total, [rollTotal, ratio]): [number, number, number][] => {\n      const min = rollTotal, max = rollTotal;\n      if (!total.length) {\n        return [[min, max, ratio]];\n      }\n      const [lastMin, lastMax, lastRatio] = total[total.length - 1];\n      if (lastMax !== (max - 1) || lastRatio !== ratio) {\n        return [...total, [min, max, ratio]];\n      }\n      return [...total.slice(0, total.length - 1), [lastMin, max, lastRatio]];\n    }, [] as [number, number, number][]);\n  }\n}\n","import _ from \"underscore\";\n\nimport {CompressedSerialisedResults, Results, SerialisedResults} from \"./Results\";\n\nexport interface SerialisedEvaluation {\n  minimumResultOccurrencesEntries: SerialisedResults,\n  exactResultOccurrencesEntries: SerialisedResults,\n  expectedValue: number,\n}\n\nexport interface CompressedSerialisedEvaluation {\n  minimumResultOccurrencesEntries: CompressedSerialisedResults,\n  exactResultOccurrencesEntries: SerialisedResults,\n  expectedValue: number,\n}\n\nexport class Evaluation {\n  minimumResultOccurrences: Results;\n  exactResultOccurrences: Results;\n  expectedValue: number;\n\n  static combineOptions(options: Evaluation[]): Evaluation {\n    const combined = this.empty();\n    let maxExpectedValue = 0;\n    for (const evaluation of options) {\n      for (const [result, count] of evaluation.minimumResultOccurrences.entries()) {\n        combined.minimumResultOccurrences.set(result, Math.max(combined.minimumResultOccurrences.get(result) || 0, count));\n      }\n      for (const [result, count] of evaluation.exactResultOccurrences.entries()) {\n        combined.exactResultOccurrences.set(result, Math.max(combined.exactResultOccurrences.get(result) || 0, count));\n      }\n      maxExpectedValue = Math.max(maxExpectedValue, evaluation.expectedValue);\n    }\n    combined.expectedValue = maxExpectedValue;\n    return combined;\n  }\n\n  static combineProbabilities(options: {evaluation: Evaluation, ratio: number}[]): Evaluation {\n    const combined = this.empty();\n    let expectedValue = 0;\n    for (const {evaluation, ratio: evaluationRatio} of options) {\n      for (const [result, ratio] of evaluation.minimumResultOccurrences.entries()) {\n        combined.minimumResultOccurrences.set(result, (combined.minimumResultOccurrences.get(result) || 0) + ratio * evaluationRatio);\n      }\n      for (const [result, ratio] of evaluation.exactResultOccurrences.entries()) {\n        combined.exactResultOccurrences.set(result, (combined.exactResultOccurrences.get(result) || 0) + ratio * evaluationRatio);\n      }\n      expectedValue += evaluation.expectedValue * evaluationRatio;\n    }\n    combined.expectedValue = expectedValue;\n    return combined;\n  }\n\n  static fromTotal(total: number): Evaluation {\n    const evaluation = this.empty();\n    for (const minTotal of _.range(1, total + 1)) {\n      evaluation.minimumResultOccurrences.set(minTotal, 1);\n    }\n    evaluation.exactResultOccurrences.set(total, 1);\n    evaluation.expectedValue = total;\n    return evaluation;\n  }\n\n  static empty(): Evaluation {\n    return new Evaluation(new Results(), new Results(), 0);\n  }\n\n  static deserialise(serialised: SerialisedEvaluation): Evaluation {\n    return new Evaluation(\n      Results.deserialise(serialised.minimumResultOccurrencesEntries),\n      Results.deserialise(serialised.exactResultOccurrencesEntries),\n      serialised.expectedValue ?? 0,\n    );\n  }\n\n  static deserialiseCompressed(serialised: CompressedSerialisedEvaluation): Evaluation {\n    return new Evaluation(\n      Results.deserialiseCompressed(serialised.minimumResultOccurrencesEntries),\n      Results.deserialise(serialised.exactResultOccurrencesEntries),\n      serialised.expectedValue ?? 0,\n    );\n  }\n\n  constructor(minimumResultOccurrences: Results, exactResultOccurrences: Results, expectedValue: number) {\n    this.minimumResultOccurrences = minimumResultOccurrences;\n    this.exactResultOccurrences = exactResultOccurrences;\n    this.expectedValue = expectedValue;\n  }\n\n  toFixed(): Evaluation {\n    return new Evaluation(\n      this.minimumResultOccurrences.toFixed(),\n      this.exactResultOccurrences.toFixed(),\n      parseFloat(this.expectedValue.toFixed(6)),\n    );\n  }\n\n  serialise(): SerialisedEvaluation {\n    return {\n      minimumResultOccurrencesEntries: this.minimumResultOccurrences.serialise(),\n      exactResultOccurrencesEntries: this.exactResultOccurrences.serialise(),\n      expectedValue: this.expectedValue,\n    };\n  }\n\n  serialiseCompressed(): CompressedSerialisedEvaluation {\n    return {\n      minimumResultOccurrencesEntries: this.minimumResultOccurrences.serialiseCompressed(),\n      exactResultOccurrencesEntries: this.exactResultOccurrences.serialise(),\n      expectedValue: this.expectedValue,\n    };\n  }\n}\n","import {Evaluation} from \"./Evaluation\";\nimport {CompressedSerialisedResults, SerialisedResults} from \"./Results\";\n\nexport interface EvaluationCacheStats {\n  hitCount: number,\n  missCount: number,\n  entryCount: number,\n}\n\nexport type SerialisedEvaluationCache = [string, SerialisedResults, SerialisedResults, number][];\nexport type CompressedSerialisedEvaluationCache = [string, CompressedSerialisedResults, SerialisedResults, number][];\n\nexport class EvaluationCache {\n  cache: Map<string, Evaluation> = new Map();\n  hitCount: number = 0;\n  missCount: number = 0;\n\n  static deserialise(serialised: SerialisedEvaluationCache): EvaluationCache {\n    const cache = new EvaluationCache();\n    for (const [key, minimumResultOccurrencesEntries, exactResultOccurrencesEntries, expectedValue] of serialised) {\n      cache.set(key, Evaluation.deserialise({\n        minimumResultOccurrencesEntries,\n        exactResultOccurrencesEntries,\n        expectedValue: expectedValue ?? 0,\n      }));\n    }\n    return cache;\n  }\n\n  static deserialiseCompressed(serialised: CompressedSerialisedEvaluationCache): EvaluationCache {\n    const cache = new EvaluationCache();\n    for (const [key, minimumResultOccurrencesEntries, exactResultOccurrencesEntries, expectedValue] of serialised) {\n      cache.set(key, Evaluation.deserialiseCompressed({\n        minimumResultOccurrencesEntries,\n        exactResultOccurrencesEntries,\n        expectedValue: expectedValue ?? 0,\n      }));\n    }\n    return cache;\n  }\n\n  get(key: string): Evaluation | undefined {\n    if (this.cache.has(key)) {\n      this.hitCount++;\n    } else {\n      this.missCount++;\n    }\n    return this.cache.get(key);\n  }\n\n  set(key: string, evaluation: Evaluation) {\n    this.cache.set(key, evaluation);\n  }\n\n  getStats(): EvaluationCacheStats {\n    return {\n      hitCount: this.hitCount,\n      missCount: this.missCount,\n      entryCount: this.cache.size,\n    };\n  }\n\n  serialise(): SerialisedEvaluationCache {\n    return Array.from(this.cache.entries()).map(\n      ([key, evaluation]) => {\n        const serialisedEvaluation = evaluation.serialise();\n        return [\n          key,\n          serialisedEvaluation.minimumResultOccurrencesEntries,\n          serialisedEvaluation.exactResultOccurrencesEntries,\n          serialisedEvaluation.expectedValue,\n        ];\n      });\n  }\n\n  serialiseCompressed(): CompressedSerialisedEvaluationCache {\n    return Array.from(this.cache.entries()).map(\n      ([key, evaluation]) => {\n        const serialisedEvaluation = evaluation.serialiseCompressed();\n        return [\n          key,\n          serialisedEvaluation.minimumResultOccurrencesEntries,\n          serialisedEvaluation.exactResultOccurrencesEntries,\n          serialisedEvaluation.expectedValue,\n        ];\n      });\n  }\n}\n","import { Chest } from \"./Chest\";\nimport { DiceRoll } from \"./DiceRoll\";\nimport { RolledState } from \"./RolledState\";\nimport { RollResult } from \"./RollResult\";\n\nexport interface SerialisedUnrolledState {\n  chestDice: RollResult[],\n  remainingDiceCount: number,\n}\n\nexport class UnrolledState {\n  chest: Chest;\n  remainingDiceCount: number;\n\n  static initial(): UnrolledState {\n    return new UnrolledState(Chest.initial(), 8);\n  }\n\n  static empty(): UnrolledState {\n    return new UnrolledState(Chest.initial(), 0);\n  }\n\n  static fromDice(dice: RollResult[], remainingDiceCount: number): UnrolledState {\n    return new UnrolledState(Chest.fromDice(dice), remainingDiceCount);\n  }\n\n  static deserialise(serialised: SerialisedUnrolledState): UnrolledState {\n    return UnrolledState.fromDice(serialised.chestDice, serialised.remainingDiceCount);\n  }\n\n  constructor(chest: Chest, remainingDiceCount: number) {\n    this.chest = chest;\n    this.remainingDiceCount = remainingDiceCount;\n  }\n\n  get total(): number {\n    if (this.chest.hasWorms) {\n      return this.chest.total;\n    } else {\n      return 0;\n    }\n  }\n\n  get totalDiceCount(): number {\n    return this.chest.diceCount + this.remainingDiceCount;\n  }\n\n  getNextRolledStates(): {rolledState: RolledState, count: number}[] {\n    return DiceRoll.getNextRolls(this.remainingDiceCount).map(({diceRoll, count}) => ({\n      rolledState: this.withRoll(diceRoll), \n      count,\n    }));\n  }\n\n  withRoll(diceRoll: DiceRoll): RolledState {\n    return new RolledState(this, diceRoll);\n  }\n\n  canAdd(roll: RollResult): boolean {\n    return this.chest.canAdd(roll);\n  }\n\n  add(roll: RollResult, diceCount: number): UnrolledState {\n    return new UnrolledState(this.chest.add(roll, diceCount), this.remainingDiceCount - diceCount);\n  }\n\n  finished(): UnrolledState {\n    return new UnrolledState(this.chest, 0);\n  }\n\n  serialise(): SerialisedUnrolledState {\n    return {\n      chestDice: this.chest.dice,\n      remainingDiceCount: this.remainingDiceCount,\n    };\n  }\n}\n","import {DiceRoll} from \"./DiceRoll\";\nimport {RollResult} from \"./RollResult\";\nimport {UnrolledState} from \"./UnrolledState\";\n\nexport class RolledState {\n  unrolledState: UnrolledState;\n  diceRoll: DiceRoll;\n\n  static fromDice(chestDice: RollResult[], rolledDice: RollResult[]): RolledState {\n    return new RolledState(UnrolledState.fromDice(chestDice, rolledDice.length), DiceRoll.fromDice(rolledDice));\n  }\n\n  constructor(unrolledState: UnrolledState, diceRoll: DiceRoll) {\n    this.unrolledState = unrolledState;\n    this.diceRoll = diceRoll;\n  }\n\n  get total(): number {\n    return this.unrolledState.total;\n  }\n\n  getNextUnrolledStates(): UnrolledState[] {\n    const nextUnrolledStates = Array.from(this.diceRoll.entries())\n      .filter(([roll]) => this.unrolledState.canAdd(roll))\n      .map(([roll, diceCount]) => this.unrolledState.add(roll, diceCount));\n    if (!nextUnrolledStates.length) {\n      return [this.unrolledState.finished()];\n    }\n    return nextUnrolledStates;\n  }\n}\n","import {Evaluation} from \"./Evaluation\";\nimport {RolledState} from \"./RolledState\";\nimport {RolledStateEvaluator} from \"./RolledStateEvaluator\";\nimport {UnrolledState} from \"./UnrolledState\";\nimport {EvaluationCache} from \"./EvaluationCache\";\n\ninterface NextRolledState {\n  rolledState: RolledState;\n  count: number;\n  evaluator: RolledStateEvaluator | null;\n  evaluation: Evaluation | null;\n}\n\ninterface SearchOptions {\n  removeEvaluated?: boolean,\n  evaluationCache?: EvaluationCache,\n}\n\nexport class UnrolledStateEvaluator {\n  unrolledState: UnrolledState;\n  nextRolledStates: NextRolledState[] | null;\n  evaluation: Evaluation | null = null;\n  isRoot: boolean;\n\n  static fromUnrolledState(unrolledState: UnrolledState, isRoot: boolean): UnrolledStateEvaluator {\n    const nextRolledStates = unrolledState.getNextRolledStates();\n    return new UnrolledStateEvaluator(\n      unrolledState,\n      nextRolledStates.map(nextRolledState => ({...nextRolledState, evaluator: null, evaluation: null})),\n      isRoot,\n    );\n  }\n\n  static fromUnrolledStateLazy(unrolledState: UnrolledState, isRoot: boolean): UnrolledStateEvaluator {\n    return new UnrolledStateEvaluator(\n      unrolledState,\n      null,\n      isRoot,\n    );\n  }\n\n  constructor(unrolledState: UnrolledState, nextRolledStates: NextRolledState[] | null, isRoot: boolean) {\n    this.unrolledState = unrolledState;\n    this.nextRolledStates = nextRolledStates;\n    this.isRoot = isRoot;\n  }\n\n  get finished(): boolean {\n    return this.evaluation !== null;\n  }\n\n  processAll(): UnrolledStateEvaluator {\n    while (this.processOne()) {\n      //\n    }\n    return this;\n  }\n\n  processOne(options?: SearchOptions): boolean {\n    if (this.finished) {\n      return false;\n    }\n    if (this.nestedProcessOne(options)) {\n      return true;\n    }\n    if (!this.evaluation) {\n      this.evaluation = this.compileEvaluation();\n      if (this.isRoot) {\n        this.setOwnEvaluationCache(options);\n      }\n    }\n    return false;\n  }\n\n  nestedProcessOne(options?: SearchOptions): boolean {\n    const {removeEvaluated = false} = options ?? {};\n    if (this.finished) {\n      return false;\n    }\n    if (!this.nextRolledStates) {\n      if (options?.evaluationCache) {\n        const evaluation = options.evaluationCache.get(this.getCacheKey());\n        if (evaluation) {\n          this.evaluation = evaluation;\n          return false;\n        }\n      }\n      this.nextRolledStates = this.unrolledState\n        .getNextRolledStates()\n        .map(nextRolledState => ({...nextRolledState, evaluator: null, evaluation: null}));\n    }\n    for (const nextRolledState of this.nextRolledStates) {\n      if (nextRolledState.evaluation) {\n        continue;\n      }\n      if (!nextRolledState.evaluator) {\n        nextRolledState.evaluator = RolledStateEvaluator.fromRolledState(nextRolledState.rolledState);\n        if (this.useEvaluationCache(nextRolledState, options)) {\n          continue;\n        }\n      }\n      nextRolledState.evaluator.processOne(options);\n      if (nextRolledState.evaluator.evaluation) {\n        nextRolledState.evaluation = nextRolledState.evaluator.evaluation;\n        this.setEvaluationCache(nextRolledState, options);\n        if (removeEvaluated) {\n          nextRolledState.evaluator = null;\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n\n  useEvaluationCache(nextRolledState: NextRolledState, options?: SearchOptions): boolean {\n    if (!nextRolledState.evaluator) {\n      return false;\n    }\n    const {removeEvaluated = false, evaluationCache} = options ?? {};\n    const evaluation = evaluationCache?.get(nextRolledState.evaluator.getCacheKey());\n    if (evaluation) {\n      nextRolledState.evaluation = evaluation;\n      if (removeEvaluated) {\n        nextRolledState.evaluator = null;\n      }\n      return true;\n    }\n    return false;\n  }\n\n\n  setEvaluationCache(nextRolledState: NextRolledState, options?: SearchOptions) {\n    if (!nextRolledState.evaluator || !nextRolledState.evaluation) {\n      return;\n    }\n    const {evaluationCache} = options ?? {};\n    if (evaluationCache) {\n      evaluationCache.set(nextRolledState.evaluator.getCacheKey(), nextRolledState.evaluation);\n    }\n  }\n\n  setOwnEvaluationCache(options?: SearchOptions) {\n    if (!this.evaluation) {\n      return;\n    }\n    const {evaluationCache} = options ?? {};\n    if (evaluationCache) {\n      evaluationCache.set(this.getCacheKey(), this.evaluation);\n    }\n  }\n\n  getCacheKey(): string {\n    return [\n      \"S\",\n      `t${this.unrolledState.chest.total}`,\n      `c${this.unrolledState.chest.uniqueDice().join(\",\")}`,\n      `r${this.unrolledState.remainingDiceCount}`,\n    ].join(\"\").replaceAll(/[[\\]]/g, \"\");\n  }\n\n  compileEvaluation(): Evaluation {\n    if (!this.nextRolledStates || this.nextRolledStates.some(({evaluation}) => !evaluation)) {\n      throw new Error(\"Some part of the evaluation tree is not completed\");\n    }\n    return this.compilePartialEvaluation({useCached: false});\n  }\n\n  getCompletionProgress(): number {\n    if (this.finished) {\n      return 1;\n    }\n    if (!this.nextRolledStates) {\n      return 0;\n    }\n    if (!this.nextRolledStates.length) {\n      return 1;\n    }\n    const completedCount = this.nextRolledStates.reduce(\n      (total, current) => total + (current.evaluation ? 1 : (current.evaluator?.getCompletionProgress() ?? 0)), 0);\n    return completedCount / this.nextRolledStates.length;\n  }\n\n  compilePartialEvaluation({useCached = true}: {useCached?: boolean} = {}): Evaluation {\n    if (this.evaluation && useCached) {\n      return this.evaluation;\n    }\n    if (!this.nextRolledStates) {\n      return Evaluation.empty();\n    }\n    if (!this.nextRolledStates.length) {\n      return Evaluation.fromTotal(this.unrolledState.total);\n    }\n    const totalCount = this.nextRolledStates.reduce((total, current) => total + current.count, 0);\n    const combined = Evaluation.combineProbabilities(\n      this.nextRolledStates\n      .filter(({evaluator, evaluation}) => evaluator || evaluation)\n      .map(({evaluator, evaluation, count}) => ({\n        evaluation: evaluation ?? evaluator!.compilePartialEvaluation(),\n        ratio: count / totalCount,\n      }))\n    );\n    // Because we can choose to stop, the current total has 100% chance of happening, if it's our target\n    combined.exactResultOccurrences.set(this.unrolledState.total, 1);\n    return combined;\n  }\n}\n","import {Evaluation} from \"./Evaluation\";\nimport {RolledState} from \"./RolledState\";\nimport {UnrolledState} from \"./UnrolledState\";\nimport {UnrolledStateEvaluator} from \"./UnrolledStateEvaluator\";\nimport {EvaluationCache} from \"./EvaluationCache\";\n\ninterface NextUnrolledState {\n  unrolledState: UnrolledState;\n  evaluator: UnrolledStateEvaluator | null;\n  evaluation: Evaluation | null;\n}\n\ninterface SearchOptions {\n  removeEvaluated?: boolean,\n  evaluationCache?: EvaluationCache,\n}\n\nexport class RolledStateEvaluator {\n  rolledState: RolledState;\n  nextUnrolledStates: NextUnrolledState[];\n  evaluation: Evaluation | null = null;\n\n  static fromRolledState(rolledState: RolledState): RolledStateEvaluator {\n    const nextUnrolledStates = rolledState.getNextUnrolledStates();\n    return new RolledStateEvaluator(\n      rolledState,\n      nextUnrolledStates.map(unrolledState => ({unrolledState, evaluator: null, evaluation: null})),\n    );\n  }\n\n  constructor(rolledState: RolledState, nextUnrolledStates: NextUnrolledState[]) {\n    this.rolledState = rolledState;\n    this.nextUnrolledStates = nextUnrolledStates;\n  }\n\n  get finished(): boolean {\n    return this.evaluation !== null;\n  }\n\n  processAll(): RolledStateEvaluator {\n    while (this.processOne()) {\n      //\n    }\n    return this;\n  }\n\n  processOne(options?: SearchOptions): boolean {\n    if (this.finished) {\n      return false;\n    }\n    if (this.nestedProcessOne(options)) {\n      return true;\n    }\n    this.evaluation = this.compileEvaluation();\n    return false;\n  }\n\n  nestedProcessOne(options?: SearchOptions): boolean {\n    const {removeEvaluated = false} = options ?? {};\n    if (this.finished) {\n      return false;\n    }\n    for (const nextUnrolledState of this.nextUnrolledStates) {\n      if (nextUnrolledState.evaluation) {\n        continue;\n      }\n      if (!nextUnrolledState.evaluator) {\n        nextUnrolledState.evaluator = UnrolledStateEvaluator.fromUnrolledState(nextUnrolledState.unrolledState, false);\n        if (this.useEvaluationCache(nextUnrolledState, options)) {\n          continue;\n        }\n      }\n      nextUnrolledState.evaluator.processOne(options);\n      if (nextUnrolledState.evaluator.evaluation) {\n        nextUnrolledState.evaluation = nextUnrolledState.evaluator.evaluation;\n        this.setEvaluationCache(nextUnrolledState, options);\n        if (removeEvaluated) {\n          nextUnrolledState.evaluator = null;\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n\n  useEvaluationCache(nextUnrolledState: NextUnrolledState, options?: SearchOptions): boolean {\n    if (!nextUnrolledState.evaluator) {\n      return false;\n    }\n    const {removeEvaluated = false, evaluationCache} = options ?? {};\n    const evaluation = evaluationCache?.get(nextUnrolledState.evaluator.getCacheKey());\n    if (evaluation) {\n      nextUnrolledState.evaluation = evaluation;\n      if (removeEvaluated) {\n        nextUnrolledState.evaluator = null;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  setEvaluationCache(nextUnrolledState: NextUnrolledState, options?: SearchOptions) {\n    if (!nextUnrolledState.evaluator || !nextUnrolledState.evaluation) {\n      return;\n    }\n    const {evaluationCache} = options ?? {};\n    if (evaluationCache) {\n      evaluationCache.set(nextUnrolledState.evaluator.getCacheKey(), nextUnrolledState.evaluation);\n    }\n  }\n\n  getCacheKey(): string {\n    return [\n      \"R\",\n      `t${this.rolledState.unrolledState.chest.total}`,\n      `c${this.rolledState.unrolledState.chest.uniqueDice().join(\",\")}`,\n      `d${this.rolledState.diceRoll.key}`,\n    ].join(\"\").replaceAll(/[[\\]]/g, \"\");\n  }\n\n  compileEvaluation(): Evaluation {\n    if (this.nextUnrolledStates.some(({evaluation}) => !evaluation)) {\n      throw new Error(\"Some part of the evaluation tree is not completed\");\n    }\n    return this.compilePartialEvaluation({useCached: false});\n  }\n\n  getCompletionProgress(): number {\n    if (this.finished) {\n      return 1;\n    }\n    const completedCount = this.nextUnrolledStates.reduce(\n      (total, current) => total + (current.evaluation ? 1 : (current.evaluator?.getCompletionProgress() ?? 0)), 0);\n    return completedCount / this.nextUnrolledStates.length;\n  }\n\n  compilePartialEvaluation({useCached = true}: {useCached?: boolean} = {}): Evaluation {\n    if (this.evaluation && useCached) {\n      return this.evaluation;\n    }\n    return Evaluation.combineOptions(\n      this.nextUnrolledStates\n      .filter(({evaluator, evaluation}) => evaluator || evaluation)\n      .map(({evaluator, evaluation}) => evaluation ?? evaluator!.compilePartialEvaluation())\n    );\n  }\n}\n","import * as worms from \"./worms\";\n\nexport class EvaluationCacheCache {\n  evaluationCacheUrlMap: Map<number, string> = new Map([\n    [5, \"evaluation-cache-5-dice.json\"],\n    [6, \"evaluation-cache-6-dice.json\"],\n    [7, \"evaluation-cache-7-dice.json\"],\n    [8, \"evaluation-cache-8-dice.json\"],\n  ]);\n  // Reusable evaluation caches\n  evaluationCacheMap: Map<number, worms.EvaluationCache> = new Map();\n\n  async get(diceCount: number): Promise<worms.EvaluationCache> {\n    if (!this.evaluationCacheMap.has(diceCount)) {\n      this.evaluationCacheMap.set(diceCount, await this.fetchEvaluationCache(diceCount) ?? new worms.EvaluationCache());\n    }\n    return this.evaluationCacheMap.get(diceCount)!;\n  }\n\n  getSync(diceCount: number, callback: (evaluationCache: worms.EvaluationCache) => void): worms.EvaluationCache {\n    if (!this.evaluationCacheMap.has(diceCount)) {\n      (async () => {\n        callback(await this.get(diceCount));\n      })();\n      this.evaluationCacheMap.set(diceCount, new worms.EvaluationCache());\n    }\n    return this.evaluationCacheMap.get(diceCount)!;\n  }\n\n  async fetchEvaluationCache(diceCount: number): Promise<worms.EvaluationCache | null> {\n    const evaluationCacheUrl = this.evaluationCacheUrlMap.get(diceCount);\n    if (!evaluationCacheUrl) {\n      return null;\n    }\n    const response = await fetch(`${process.env.PUBLIC_URL}/${evaluationCacheUrl}`);\n    try {\n      return worms.EvaluationCache.deserialiseCompressed(JSON.parse(await response.text()));\n    } catch (e) {\n      console.error(\"File was not a valid cache file\");\n      return null;\n    }\n  }\n\n  clear(diceCount: number): worms.EvaluationCache {\n    this.evaluationCacheMap.set(diceCount, new worms.EvaluationCache());\n    return this.evaluationCacheMap.get(diceCount)!;\n  }\n}\n","import {SearchRequestMessage, SearchResponseMessage} from \"./RemoteSearch\";\nimport * as worms from \"./worms\";\nimport {EvaluationCacheCache} from \"./EvaluationCacheCache\";\n\ninterface InstanceInfo {\n  id: number,\n  unrolledStateEvaluator: worms.UnrolledStateEvaluator,\n  searching: boolean,\n  evaluationCache: worms.EvaluationCache,\n}\n\nclass SearchWorker {\n  instancesById: Map<number, InstanceInfo> = new Map();\n  worker: Worker;\n  evaluationCacheCache: EvaluationCacheCache = new EvaluationCacheCache();\n\n  static default(): SearchWorker {\n    return new SearchWorker(self as unknown as Worker);\n  }\n\n  constructor(worker: Worker) {\n    this.worker = worker;\n    this.worker.onmessage = this.onMessage;\n  }\n\n  private postMessage(message: SearchResponseMessage) {\n    this.worker.postMessage(message);\n  }\n\n  postResult(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    const {unrolledStateEvaluator, searching, evaluationCache} = this.instancesById.get(instanceId)!;\n    const progress = unrolledStateEvaluator.getCompletionProgress();\n    this.postMessage({\n      type: \"result\",\n      id: instanceId,\n      progress,\n      searching,\n      searchFinished: progress === 1,\n      evaluation: unrolledStateEvaluator.compilePartialEvaluation().serialise(),\n      cacheStats: evaluationCache.getStats(),\n    });\n  }\n\n  onMessage = ({data}: MessageEvent<SearchRequestMessage>) => {\n    switch (data.type) {\n      case \"set-unrolled-state\":\n        this.onSetUnrolledState(data.id, worms.UnrolledState.deserialise(data.state));\n        break;\n      case \"step\":\n        this.onStep(data.id);\n        break;\n      case \"start\":\n        this.onStart(data.id);\n        break;\n      case \"stop\":\n        this.onStop(data.id);\n        break;\n      case \"remove\":\n        this.onRemove(data.id);\n        break;\n      case \"download-evaluation-cache\":\n        this.onDownloadEvaluationCache(data.id);\n        break;\n      case \"load-evaluation-cache\":\n        this.onLoadEvaluationCache(data.id, data.jsonSerialised);\n        break;\n      case \"clear-evaluation-cache\":\n        this.onClearEvaluationCache(data.id);\n        break;\n    }\n  };\n\n  onSetUnrolledState(instanceId: number, unrolledState: worms.UnrolledState) {\n    this.onStop(instanceId);\n    this.instancesById.set(instanceId, {\n      id: instanceId,\n      unrolledStateEvaluator: worms.UnrolledStateEvaluator.fromUnrolledStateLazy(unrolledState, true),\n      searching: false,\n      evaluationCache: this.evaluationCacheCache.getSync(unrolledState.totalDiceCount, evaluationCache => {\n        const instance = this.instancesById.get(instanceId);\n        if (!instance) {\n          return;\n        }\n        instance.evaluationCache = evaluationCache;\n        this.postResult(instanceId);\n      }),\n    });\n  }\n\n  onStep(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    const {unrolledStateEvaluator, evaluationCache} = this.instancesById.get(instanceId)!;\n    unrolledStateEvaluator.processOne({removeEvaluated: true, evaluationCache});\n    this.postResult(instanceId);\n  }\n\n  onStart(instanceId: number) {\n    this.onStop(instanceId);\n    const iterator = this.makeSearch(instanceId);\n    if (!iterator) {\n      return;\n    }\n    self.setTimeout(iterator, 0);\n  }\n\n  onDownloadEvaluationCache(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    const {evaluationCache} = this.instancesById.get(instanceId)!;\n    const bytes = new TextEncoder().encode(JSON.stringify(evaluationCache.serialiseCompressed()));\n    const blob = new Blob([bytes], {\n      type: \"application/json;charset=utf-8\",\n    });\n    const url = URL.createObjectURL(blob);\n    self.postMessage({\n      type: \"evaluation-cache-link\",\n      id: instanceId,\n      link: url,\n    });\n  }\n\n  onLoadEvaluationCache(instanceId: number, jsonSerialised: string) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    const instance = this.instancesById.get(instanceId)!;\n    try {\n      instance.evaluationCache = worms.EvaluationCache.deserialiseCompressed(JSON.parse(jsonSerialised));\n    } catch (e) {\n      console.error(\"File was not a valid cache file\");\n      return;\n    }\n    this.postResult(instanceId);\n  }\n\n  onClearEvaluationCache(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    const instance = this.instancesById.get(instanceId)!;\n    instance.evaluationCache = new worms.EvaluationCache();\n    this.postResult(instanceId);\n  }\n\n  makeSearch(instanceId: number, reportInterval: number = 1000): (() => void) | null {\n    if (!this.instancesById.has(instanceId)) {\n      return null;\n    }\n    const instanceInfo = this.instancesById.get(instanceId)!;\n    instanceInfo.searching = true;\n    const iterator = () => {\n      const startTime = new Date();\n      while (instanceInfo.searching && !instanceInfo.unrolledStateEvaluator.finished) {\n        instanceInfo.unrolledStateEvaluator.processOne({removeEvaluated: true, evaluationCache: instanceInfo.evaluationCache});\n        const endTime = new Date();\n        if ((endTime.valueOf() - startTime.valueOf()) >= reportInterval) {\n          self.setTimeout(iterator, 0);\n          break;\n        }\n      }\n      this.postResult(instanceId);\n    };\n    return iterator;\n  }\n\n  onStop(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    this.instancesById.get(instanceId)!.searching = false;\n    this.postResult(instanceId);\n  }\n\n  onRemove(instanceId: number) {\n    if (!this.instancesById.has(instanceId)) {\n      return;\n    }\n    this.instancesById.get(instanceId)!.searching = false;\n    this.postResult(instanceId);\n    this.instancesById.delete(instanceId);\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst worker = SearchWorker.default();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [871], function() { return __webpack_require__(9150); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"6b4d62fe\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/probable-worms/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t150: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkprobable_worms\"] = self[\"webpackChunkprobable_worms\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(871).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["Worm","rollResults","ValueMap","Map","DiceRoll","items","_classCallCheck","counts","key","total","this","JSON","stringify","Array","from","entries","sort","reduce","_ref","_ref2","_slicedToArray","roll","count","get","_createClass","value","concat","_toConsumableArray","has","keys","size","values","current","map","_ref3","_ref4","_","flat","lhs","rhs","set","delete","dice","Object","group","length","diceCount","_step","diceRollInfoByKey","_iterator","_createForOfIteratorHelper","iterateDiceRolls","s","n","done","diceRoll","err","e","f","_regeneratorRuntime","mark","_marked","addLayer","_1","_iterator4","_step4","item","wrap","_context2","prev","next","lists","layer","_iterator2","_step2","list","_iterator3","_step3","newItem","_context","t0","finish","t1","stop","abrupt","fromDice","Chest","diceCounts","hasWorms","canAdd","Error","adding","fromDiceRoll","replacing","Results","other","_step$value","result","_value$constructor","isNaN","parseFloat","toFixed","constructor","name","serialise","_ref7","_ref8","rollTotal","ratio","min","max","_total","lastMin","lastMax","lastRatio","slice","serialised","serialisedCompressed","_ref9","_ref10","Evaluation","minimumResultOccurrences","exactResultOccurrences","expectedValue","minimumResultOccurrencesEntries","exactResultOccurrencesEntries","serialiseCompressed","options","combined","empty","maxExpectedValue","evaluation","_step2$value","Math","_step3$value","_step5","_step4$value","evaluationRatio","_iterator5","_step5$value","_step6","_iterator6","_step6$value","_step7","_iterator7","minTotal","_serialised$expectedV","deserialise","_serialised$expectedV2","deserialiseCompressed","EvaluationCache","cache","hitCount","missCount","entryCount","serialisedEvaluation","UnrolledState","chest","remainingDiceCount","_this","getNextRolls","rolledState","withRoll","RolledState","add","chestDice","initial","unrolledState","nextUnrolledStates","filter","finished","rolledDice","UnrolledStateEvaluator","nextRolledStates","isRoot","processOne","nestedProcessOne","compileEvaluation","setOwnEvaluationCache","_ref$removeEvaluated","removeEvaluated","evaluationCache","getCacheKey","getNextRolledStates","nextRolledState","_objectSpread","evaluator","RolledStateEvaluator","fromRolledState","useEvaluationCache","setEvaluationCache","_ref2$removeEvaluated","uniqueDice","join","replaceAll","some","_ref5","compilePartialEvaluation","useCached","_current$evaluator$ge","_current$evaluator","getCompletionProgress","_ref6$useCached","arguments","undefined","fromTotal","totalCount","combineProbabilities","nextUnrolledState","fromUnrolledState","_ref5$useCached","combineOptions","_ref6","getNextUnrolledStates","EvaluationCacheCache","evaluationCacheUrlMap","evaluationCacheMap","_get","_asyncToGenerator","_callee","_yield$this$fetchEval","fetchEvaluationCache","t3","sent","t2","t4","worms","t5","call","_x","apply","callback","_callee2","_fetchEvaluationCache","_callee3","evaluationCacheUrl","response","_context3","fetch","process","text","parse","console","error","_x2","SearchWorker","worker","instancesById","evaluationCacheCache","onMessage","data","type","onSetUnrolledState","id","state","onStep","onStart","onStop","onRemove","onDownloadEvaluationCache","onLoadEvaluationCache","jsonSerialised","onClearEvaluationCache","onmessage","message","postMessage","instanceId","unrolledStateEvaluator","searching","progress","searchFinished","cacheStats","getStats","_this2","getSync","totalDiceCount","instance","postResult","iterator","makeSearch","self","setTimeout","bytes","TextEncoder","encode","blob","Blob","url","URL","createObjectURL","link","_this3","reportInterval","instanceInfo","startTime","Date","valueOf","default","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","every","splice","r","d","definition","o","defineProperty","enumerable","chunkId","Promise","all","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","push","bind","moreModules","runtime","pop","then"],"sourceRoot":""}